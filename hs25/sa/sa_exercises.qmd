---
title: "Classical and Bayesian Statistics - Exercises"
toc: true
---

# Problems 1

## a

It seems that, in total, the Allied and Axis countries had about the same number of civilian deaths. However, if we compare the numbers per party member, we see that the Axis countries had a higher average amount of deaths. On the other hand, the data from the Allies is inconsistent (see Denmark).

## b

The percentages in the chart do not sum up to 100%.

## c

### I

We can assume that Linda is a bank teller and is active in the feminist movement. Her experiences from the past could have influenced her behavior and thinking on certain topics. She may have a sense for justice and equality, regardless of the topic.

### II

We can assume that Steve is a librarian because of his helpful personality and his need for order and structure, much like what's found in a library. His passion for details may also be connected to a desire for knowledge.

### III

A Ball costs $0.05.

### IV

There are more death by heart diseases than accidents.

## d

Since the engine is the only thing that keeps a plane in the air, it makes sense for it to be more armoured than the rest of the plane. Even if other parts have more bullet holes on average (e.g. the fuselage), the plane could still fly.

# Problem 1.2

```{r}
# Define vectors
winner <- c(193, 183, 191, 185, 185, 182, 182, 188, 188, 188, 185, 185, 177,
182, 182, 193, 183, 179, 179, 175)

opponent <- c(163, 191, 165, 187, 175, 193, 185, 187, 188, 173, 180, 177, 183,
185, 180, 180, 182, 178, 178, 173)
```

### a

```{r}
# Determine length
cat("Length of vector winners =", length(winner), "\n") # Add line break
cat("Length of vector opponent =", length(opponent))
```

### b

```{r}
cat("Entries 6 to 10 =",winner[6:10]) # Index starts at 1
```

### c

```{r}
cat("Some values from winner:", winner[c(3, 5, 10, 12)]) # Passing a vector for selection
```

### d

```{r}
cat("Current values:",winner[c(8, 9)], "\n")  # Check values
winner[c(8, 9)] <- 189  # Reassign 
cat("New values:", winner[c(8, 9)])  # Check values
```

### e

```{r}
mu_winner <- mean(winner)
mu_opponent <- mean(opponent)

cat("Mean higth of winner vs. opponent:", mu_winner, "vs.", mu_opponent)
```

### f

```{r}
mu_diff <- mu_winner - mu_opponent

cat("Differences between means =", mu_diff)
```

### g

```{r}
var_winner <- var(winner)
sd_winner <- sd(winner)

cat("Variance / Std. deviation of winner:", var_winner, "/", sd_winner)
```

### h

```{r}
my_variance <- function(data){
    mu <- mean(data)
    sum_of_squares <- sum((data - mu)^2)
    variance <- sum_of_squares / (length(data) - 1)
    
    return(variance)
}

my_stdDeviation <- function(variance){
    stdDevition <- sqrt(variance)

    return(stdDevition)
}

my_var_winner <- my_variance(winner)
my_sd_winner <- my_stdDeviation(my_var_winner)

cat("Variance of Winner =", my_var_winner, "\n") # Add line break
cat("Variance of Winner =", my_sd_winner)
```

## Problem 1.3

```{r}
grades <- c(4.2, 2.3, 5.6, 4.5, 4.8, 3.9, 5.9, 2.4, 5.9, 6, 4, 3.7, 5, 5.2, 4.5, 3.6, 5, 6, 2.8, 3.3, 5.5, 4.2, 4.9, 5.1)

grades <- sort(grades) # Sort values

original_mu <- mean(grades)
originla_meadian <- median(grades)

grades[9:11] <- 1 # Reassign values
new_mu <- mean(grades)
new_median <- median(grades)

cat("Original vs. New mean:", original_mu, "vs.", new_mu, "\n") # Add line break
cat("Median stays the same:", originla_meadian, "=", new_median)
```

# Problems 2

## Probmel 2.1

### a

```{r}
# Read data
data <- read.csv('/home/nils/dev/mscids-notes/hs25/sa/data/husband_wife.csv')
head(data)
```

### b

```{r}
summary(data)
```

For each column, we see a brief summary with quantitative and qualitative information about the data.

### c

```{r}
age_diff <- data$age.husband - data$age.wife # Calc age difference

boxplot(age_diff)
```

### d

- The median of age_diff is about 2.5. On average, the age difference between husbands and wives is around 2.5 years.
- 50% of the differences lie between approximately 0 and 5 years.
- There are more upper than lower outliers, meaning that extreme cases where the husband is much older than the wife occur more frequently.
- In addition, the values of the upper outliers are larger than those of the lower ones.

## Problem 2.2

```{r}
head(InsectSprays) # Preview data from head
```

### a

```{r}
tapply(InsectSprays$count, InsectSprays$spray, mean)
```

### b

```{r}
boxplot(count ~ spray,
        data = InsectSprays)
```

## Problem 2.3

```{r}
data <- read.csv('/home/nils/dev/mscids-notes/hs25/sa/data/Diet.csv')
head(data)
```

```{r}
# Add column weight.los
data$weight.loss <- data$weight6weeks - data$pre.weight
data$weight.loss
```

```{r}
tapply(data$weight.loss, data$Diet, mean)
```

According to the data, diet 3 appears to have the greatest effect on weight loss over the 6-week therapy period. Diets 1 and 2 show more or less the same effect, although patients following diet 2 lost slightly less weight on average.

```{r}
boxplot(data$weight.loss ~ data$Diet)
```

- Even though diet 3 appears to have the greatest effect according to the median, it also has the largest interquartile range (IQR) among the three diets.
- Diet 2 shows the greatest overall spread across the entire boxplot
- Diet 1 is influenced by several lower outliers.

## Problem 2.4

### a

The probabilities of 'heads' and 'tails' do not add up to 1.

### b

The calculated probability is negative. That's not possible by definition.

### c

The union of the quantities `S` and `M` cannot be 0.7, because men cannot be pregnant.

## Problem 2.5

### a

Sample space of the experiment:

$$
\Omega = \{ (i, j) \mid i, j \in \{1,2,3,4,5,6\} \}
$$

### b

$$
p(\omega_n) = \dfrac{1}{36} = 0.02\bar{7}
$$

### c

Events, where the sum is 7:

$$
E_1 = {(1, 6), (2, 5), (3, 4)}
$$

> Note: Since there are two dices, we can multiply the number of favourable results by 2.

Now, we can calculate the probability:

$$
p(E_1) = \dfrac{6}{36} = 0.1\bar{6}
$$

### d

$$
E_2 = {(1, 1), (1, 2), (2, 1)}
$$

$$
p(E_2) = \dfrac{3}{36} = 0.08\bar{3}
$$

### e

$$
E_3 = \{ (i, j) \mid i, j \in \{1,3,5\} \}
$$

$$
p(E_3) = \dfrac{9}{36} = 0.25
$$

### f

```{r}
p_e2 <- 3/36
p_e3 <- 9/36
p_intersection <- 1/36

p_annual <- p_e2 + p_e3 - p_intersection

print(p_annual)
```

## Problem 2.6

```{r}
p_A <- 3/4
p_B <- 2/3
```

### a

```{r}
p_bothEvents <- p_A * p_B
print(p_bothEvents)
```

### b

```{r}
p_atLeastOne <- p_A + p_B - p_A * p_B
print(p_atLeastOne)
```

### c

```{r}
p_atMostOne <- 1 - p_A * p_B

cat(p_atMostOne)
```

### d

```{r}
p_noEvent <- 1 - (p_A + p_B - p_A * p_B)
print(p_noEvent)
```

### e

```{r}
p_exactlyOneEvent <- p_A + p_B - 2 * p_A * p_B
print(p_exactlyOneEvent)
```

## Problem 2.7

```{r}
p_earthquake <- 0.04
p_typhoon <- 0.08

p_annual <- p_earthquake + p_typhoon - p_earthquake * p_typhoon

print(p_annual)
```

# Problems 3

## Problem 3.1

$$
p_2 = 1 - 0.3 - 0.1 - 0.2 - 0.3 = 0.1
$$

## Problem 3.2

### a

The probabilities in the table sum to one, so it is a probability distribution.

$$
\sum P(X = k) = 1
$$

### b

$$
p(2 \le k \le 4) = 0.2 + 0.2 + 0.1 = 0.5
$$

### c

$$
p(k \gt 2) = 0.2 + 0.1 + 0.1 = 0.4
$$


### d

$$
p(k \le 4) = 1 - 0.1 = 0.9
$$


### e

$$
p(k \gt 1) = 1 - 0.4 = 0.6
$$


## Problem 3.3

### a

$$
p(k \le 13) = 0.992
$$

### b

$$
p(k \ge 10) = 1 - 0.939 = 0.061
$$

### c

$$
p(k = 15) = 1 - 0.999 = 0.001
$$

### d

$$
p(9 \le k \le 12) = 0.989 - 0.711 = 0.282
$$

## Problem 3.4

### a

$$
\Omega = \{\text{TTT}, \text{TTH}, \text{THT}, \text{HTT}, \text{THH}, \text{HTH}, \text{HHT}, \text{HHH}\}
$$
$$
P(X = 0) = \frac{1}{8}
$$
$$
P(X = 1) = \frac{3}{8}
$$
$$
P(X = 2) = \frac{3}{8}
$$
$$
P(X = 3) = \frac{1}{8}
$$

### b

$$
p(x = 2) = \frac{3}{8}
$$

### c

$$
p(X \ge 2) = \frac{3}{8} + \frac{1}{8} = \frac{1}{2}
$$

### d

$$
p(X \le 1) = \frac{1}{8} + \frac{3}{8} = \frac{1}{2}
$$

## Problem 3.5

```{r}
x_k <- c(-5, -4, 1, 3, 6)
p <- c(0.3, 0.1, 0.2, 0.3)
p_k <- 1 - sum(p) # Calc p_k
cat("Probability of -4 =", p_k, "\n")

p <- c(0.3, p_k, 0.1, 0.2, 0.3) # Reassign p

mu <- sum(x_k * p) # Calc expected value
mu
```

## Problem 3.6

### a

$$
p(x) = \frac{1}{6} + \frac{1}{6} = \frac{1}{3}
$$

### b

```{r}
x <- 2:12 # Sum of eyes
p <- c(1, 2, 3, 4, 5, 6, 5, 4, 3, 2, 1) / 36 # Probability of summed eyes

mu = sum(x * p)
mu

var = sum((x - mu)**2 * p)
var

sd = sqrt(var)
sd
```

# Problems 4

## Problem 4.2

```{r}
# Define distr. paras
mu <- 4
sd <- 1.25
```

### a

```{r}
# Assume normal distr.
pnorm(q = 2.5, mean = mu, sd = sd)
```

### b

```{r}
1 - pnorm(q = 5.0, mean = mu, sd = sd)
```

### c

```{r}
pnorm(q = 4.5, mean = mu, sd = sd) - pnorm(q = 3.0, mean = mu, sd = sd)
```

### d

```{r}
qnorm(0.98, mean=mu, sd=sd)
```

## Problem 4.3

```{r}
# Define distr. paras
mu <- 2.2
sd <- 0.3

# Assume normal distr.
1 - pnorm(q=3.1, mean=mu, sd=sd/sqrt(100))
```

## Problem 4.4

```{r}
# Define distr. paras
mu <- 8.2
sd <- 6.0
```

### a

```{r}
# Assume normal distr.
pnorm(q=10.0, mean=mu, sd=sd/sqrt(36))
```

### b

```{r}
pnorm(q=10.0, mean=mu, sd=sd/sqrt(36)) - pnorm(q=5.0, mean=mu, sd=sd/sqrt(36))
```

### c

```{r}
1- pnorm(q=20.0, mean=mu, sd=sd/sqrt(36))
```

### d

It's small, but not impossible. We also assume a normal distribution. The real distribution probability may differ from the normal distribution. We also use a very small sample size of 36.

### e

Yes, the i.i.d. assumption holds here because each of the 36 passengers is an individual who is independent of the others.

## Problem 4.5

```{r}
# Define distr. paras
mu <- 77
sd <- 15

course_1 <- 25
course_2 <- 64
```

### a

```{r}
# Assume normal distr.
pnorm(q=82, mean=mu, sd=sd/sqrt(course_1)) - pnorm(q=72, mean=mu, sd=sd/sqrt(course_1))
```

### b

```{r}
pnorm(q=82, mean=mu, sd=sd/sqrt(course_2)) - pnorm(q=72, mean=mu, sd=sd/sqrt(course_2))
```

For a larger group, the probability is more likely to be at the mean compared to a smaller group (CLT).

# Problems 5

# Problem 5.1

- $H_0$: $\mu = \mu_0 = 70$
- $H_A$: $\mu \lt 70$

Rejection range:

```{r}
data <- c(71, 69, 67, 68, 73, 72, 71, 71, 68, 72, 69, 72)
sd <- 1.5

mu_hat <- mean(data)

qnorm(p = 0.05, mean = 70, sd = 1.5/sqrt(12))
```

Test:

```{r}
pnorm(q = mu_hat, mean = 70, sd = 1.5 / sqrt(12))
```

We do not reject the null hypothesis.

- p-value: 0.718

The mean of the sample does not statistical deviate from the producers claimed mean.

# Problem 5.2

## a

- $H_0$: $\mu = \mu_0 = 50$
- $H_A$: $\mu \lt 50$

```{r}
data <- c(46, 48, 52, 49, 46, 51, 52, 47, 49, 44, 48, 51, 49, 50, 53, 47)
sd <- 3.0

mu_hat <- mean(data)

pnorm(q = mu_hat, mean = 50, sd = 3.0/sqrt(16))
```

We do not reject the null hypothesis.

- p-value: 0.0668072

## b

```{r}
data <- c(46, 48, 52, 49, 46, 51, 52, 47, 49, 44, 48, 51, 49, 50, 53, 47)
sd <- 3.0

mu_hat <- mean(data)

pnorm(q = mu_hat, mean = 50, sd = 3.0/sqrt(100))
```

We reject the null hypothesis.
